---
title: "EDA"
format: pdf
editor: visual
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
# load in libraries
package_list <- c("tidyverse", "vroom", "stringr", "dplyr", "ggsci", "gridExtra", "cowplot", "plotly", "urbnmapr", "quantreg")

# load in packages
for (package_name in package_list) {
  if (!requireNamespace(package_name, quietly = TRUE)) {
    install.packages(package_name)
  }
  library(package_name, character.only = TRUE)
}

# load in data
df <- vroom("shopping_behavior_updated.csv")
```

```{r}

df$location <- toupper(df$location)

state_data <- df %>%
  select(c(purchase_amount, location)) %>%
  group_by(location) %>%
  summarize(avg_purchase = mean(purchase_amount))
```

```{r}
state_abbrev <- c(
  "ALABAMA" = "AL", 
  "ALASKA" = "AK", 
  "ARIZONA" = "AZ",
  "ARKANSAS" = "AR", 
  "CALIFORNIA" = "CA", 
  "COLORADO" = "CO", 
  "CONNECTICUT" = "CT", 
  "DELAWARE" = "DE", 
  "FLORIDA"= "FL", 
  "GEORGIA" = "GA", 
  "HAWAII" = "HI", 
  "IDAHO" = "ID", 
  "ILLINOIS" = "IL", 
  "INDIANA" = "IN", 
  "IOWA" = "IA",
  "KANSAS" = "KS", 
  "KENTUCKY" = "KY", 
  "LOUISIANA" = "LA", 
  "MAINE" = "ME", 
  "MARYLAND" = "MD", 
  "MASSACHUSETTS" = "MA", 
  "MICHIGAN" = "MI", 
  "MINNESOTA" = "MN", 
  "MISSOURI" = "MO", 
  "MISSISSIPPI" = "MS",
  "MONTANA" = "MT", 
  "NEBRASKA" = "NE", 
  "NEVADA" = "NV", 
  "NEW HAMPSHIRE" = "NH", 
  "NEW JERSEY" = "NJ", 
  "NEW MEXICO" = "NM", 
  "NEW YORK" = "NY", 
  "NORTH CAROLINA" = "NC", 
  "NORTH DAKOTA" = "ND", 
  "OHIO" = "OH", 
  "OKLAHOMA" = "OK", 
  "OREGON" = "OR", 
  "PENNSYLVANIA" = "PA", 
  "RHODE ISLAND" = "RI", 
  "SOUTH CAROLINA" = "SC", 
  "SOUTH DAKOTA" = "SD", 
  "TENNESSEE" = "TN", 
  "TEXAS" = "TX", 
  "UTAH" = "UT", 
  "VERMONT" = "VT", 
  "VIRGINIA" = "VA", 
  "WASHINGTON" = "WA", 
  "WEST VIRGINIA" = "WV", 
  "WISCONSIN" = "WI", 
  "WYOMING" = "WY"
)

state_data$abb <- state_abbrev[state_data$location]
```

```{r}
# Assuming your data frame is called 'your_data'
# Make sure to replace 'state_column' and 'purchase_column' with your actual column names

# Create a basic choropleth map
#plot_ly(
  #type = 'choropleth',
  #locationmode = 'USA-states',
  #locations = (state_data$abb),
  #z = state_data$avg_purchase,
  #colorscale = 'Blues', 
  #reversescale = TRUE
#) %>% 
  #layout(
    #title = 'Average Purchase Amount per State',
    #geo = list(scope = 'usa', projection = list(type = 'albers usa'))
  #) 
```

```{r}
states <- urbnmapr::states
```

```{r}
purchase_state<- left_join(states, state_data, by = c("state_abbv" = "abb"))
```

```{r}
purchase_state %>% 
  ggplot(aes(long, lat, group = group, fill = avg_purchase)) + 
  geom_polygon(color = NA) + 
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) + 
  labs(fill = "Average Purchase")
```

```{r}
ggplot(df, aes(x = purchase_amount)) + 
  geom_histogram(binwidth = 5, fill = "orchid4", color = "black", alpha = 0.7) + 
  labs(title = "Distribution of Purchase Amount", 
       x = "Purchase Amount (USD)", 
       y = "Count")
```

```{r}

```
